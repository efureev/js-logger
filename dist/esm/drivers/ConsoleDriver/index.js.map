{"version":3,"file":"index.js","names":["ConsoleDriver","_returnResult","output","console","debug","msg","perform","info","log","error","trace","type","lines","buildStrings","formatMessage","returnResult","fmt","fmtStr","fmtArgs","getBlocks","forEach","block","str","args","formatBlock","push","getText","strStyle","style","getStyle","keyStyle"],"sources":["../../../../src/drivers/ConsoleDriver/index.ts"],"sourcesContent":["import Message from '../../Message'\nimport MessageBlock from '../../MessageBlock'\nimport { LoggerDriver } from '../LoggerDriver'\n\nexport interface FormatConsole {\n  fmtStr: string\n  fmtArgs: Array<string>\n}\n\nclass ConsoleDriver implements LoggerDriver {\n  protected _returnResult: boolean = false\n  protected output: Console = console\n\n  debug(msg: Message): string[] | void {\n    return this.perform(msg, 'debug')\n  }\n\n  info(msg: Message): string[] | void {\n    return this.perform(msg, 'info')\n  }\n\n  log(msg: Message): string[] | void {\n    return this.perform(msg, 'log')\n  }\n\n  error(msg: Message): string[] | void {\n    return this.perform(msg, 'error')\n  }\n\n  trace(msg: Message): string[] | void {\n    return this.perform(msg, 'trace')\n  }\n\n  protected perform(msg: Message, type: string): string[] | void {\n    const lines = ConsoleDriver.buildStrings(ConsoleDriver.formatMessage(msg))\n\n    if (!this._returnResult) {\n      // @ts-ignore\n      this.output[type](...lines)\n      return\n    }\n\n    this._returnResult = false\n    return lines\n  }\n\n  public returnResult(): this {\n    this._returnResult = true\n\n    return this\n  }\n\n  protected static buildStrings(fmt: FormatConsole): Array<string> {\n    return [fmt.fmtStr, ...fmt.fmtArgs]\n  }\n\n  protected static formatMessage(msg: Message): FormatConsole {\n    let fmtStr: string = ''\n    const fmtArgs: Array<string> = []\n\n    msg.getBlocks().forEach(block => {\n      const { fmtStr: str, fmtArgs: args } = ConsoleDriver.formatBlock(block)\n      fmtStr += str\n      fmtArgs.push(...args)\n    })\n\n    return { fmtStr, fmtArgs }\n  }\n\n  protected static formatBlock(block: MessageBlock): FormatConsole {\n    let fmtStr: string = `%c${block.getText()}`\n    const fmtArgs: Array<string> = []\n    let strStyle = ''\n\n    const style = block.getStyle()\n    for (const keyStyle in style) {\n      strStyle += `${keyStyle}:${style[keyStyle]};`\n    }\n    fmtArgs.push(strStyle)\n\n    return { fmtStr, fmtArgs }\n  }\n}\n\nexport default ConsoleDriver\n"],"mappings":"AASA,MAAMA,aAAN,CAA4C;EAChCC,aAAa,GAAY,KAAZ;EACbC,MAAM,GAAYC,OAAZ;;EAEhBC,KAAK,CAACC,GAAD,EAAgC;IACnC,OAAO,KAAKC,OAAL,CAAaD,GAAb,EAAkB,OAAlB,CAAP;EACD;;EAEDE,IAAI,CAACF,GAAD,EAAgC;IAClC,OAAO,KAAKC,OAAL,CAAaD,GAAb,EAAkB,MAAlB,CAAP;EACD;;EAEDG,GAAG,CAACH,GAAD,EAAgC;IACjC,OAAO,KAAKC,OAAL,CAAaD,GAAb,EAAkB,KAAlB,CAAP;EACD;;EAEDI,KAAK,CAACJ,GAAD,EAAgC;IACnC,OAAO,KAAKC,OAAL,CAAaD,GAAb,EAAkB,OAAlB,CAAP;EACD;;EAEDK,KAAK,CAACL,GAAD,EAAgC;IACnC,OAAO,KAAKC,OAAL,CAAaD,GAAb,EAAkB,OAAlB,CAAP;EACD;;EAESC,OAAO,CAACD,GAAD,EAAeM,IAAf,EAA8C;IAC7D,MAAMC,KAAK,GAAGZ,aAAa,CAACa,YAAd,CAA2Bb,aAAa,CAACc,aAAd,CAA4BT,GAA5B,CAA3B,CAAd;;IAEA,IAAI,CAAC,KAAKJ,aAAV,EAAyB;MACvB;MACA,KAAKC,MAAL,CAAYS,IAAZ,EAAkB,GAAGC,KAArB;MACA;IACD;;IAED,KAAKX,aAAL,GAAqB,KAArB;IACA,OAAOW,KAAP;EACD;;EAEMG,YAAY,GAAS;IAC1B,KAAKd,aAAL,GAAqB,IAArB;IAEA,OAAO,IAAP;EACD;;EAE4B,OAAZY,YAAY,CAACG,GAAD,EAAoC;IAC/D,OAAO,CAACA,GAAG,CAACC,MAAL,EAAa,GAAGD,GAAG,CAACE,OAApB,CAAP;EACD;;EAE6B,OAAbJ,aAAa,CAACT,GAAD,EAA8B;IAC1D,IAAIY,MAAc,GAAG,EAArB;IACA,MAAMC,OAAsB,GAAG,EAA/B;IAEAb,GAAG,CAACc,SAAJ,GAAgBC,OAAhB,CAAwBC,KAAK,IAAI;MAC/B,MAAM;QAAEJ,MAAM,EAAEK,GAAV;QAAeJ,OAAO,EAAEK;MAAxB,IAAiCvB,aAAa,CAACwB,WAAd,CAA0BH,KAA1B,CAAvC;MACAJ,MAAM,IAAIK,GAAV;MACAJ,OAAO,CAACO,IAAR,CAAa,GAAGF,IAAhB;IACD,CAJD;IAMA,OAAO;MAAEN,MAAF;MAAUC;IAAV,CAAP;EACD;;EAE2B,OAAXM,WAAW,CAACH,KAAD,EAAqC;IAC/D,IAAIJ,MAAc,GAAI,KAAII,KAAK,CAACK,OAAN,EAAgB,EAA1C;IACA,MAAMR,OAAsB,GAAG,EAA/B;IACA,IAAIS,QAAQ,GAAG,EAAf;IAEA,MAAMC,KAAK,GAAGP,KAAK,CAACQ,QAAN,EAAd;;IACA,KAAK,MAAMC,QAAX,IAAuBF,KAAvB,EAA8B;MAC5BD,QAAQ,IAAK,GAAEG,QAAS,IAAGF,KAAK,CAACE,QAAD,CAAW,GAA3C;IACD;;IACDZ,OAAO,CAACO,IAAR,CAAaE,QAAb;IAEA,OAAO;MAAEV,MAAF;MAAUC;IAAV,CAAP;EACD;;AAxEyC;;AA2E5C,eAAelB,aAAf"}