{"version":3,"file":"Logger.js","names":["Logger","driver","colors","level","LEVEL_ERROR","logLevel","msgLevel","msgText","prefix","offset","log","buildMessage","shouldLog","LEVEL_INFO","msg","info","LEVEL_DEBUG","debug","error","LEVEL_TRACE","trace","panelText","bgColor","color","baseText","Message","instance","undefined","pushBlock","MessageBlock","background","offsetLeft","borderRadius","padding","block","offsetRight"],"sources":["../../src/Logger.ts"],"sourcesContent":["import { LoggerDriver } from './drivers/LoggerDriver'\nimport type { LevelType } from './LogLevel'\nimport { LEVEL_DEBUG, LEVEL_ERROR, LEVEL_INFO, LEVEL_TRACE } from './LogLevel'\nimport Message from './Message'\nimport MessageBlock from './MessageBlock'\nimport { ColorValue } from './Color'\nimport ColorCollection from './ColorCollection'\n\nexport interface LoggerConfig {\n  driver: LoggerDriver\n  colors: ColorCollection\n  level?: LevelType\n}\n\ninterface PanelOptions {\n  bgColor?: ColorValue\n  color?: ColorValue\n  offset?: number\n}\n\nclass Logger {\n  private readonly driver: LoggerDriver\n  private readonly colors: ColorCollection\n\n  private logLevel: LevelType = LEVEL_ERROR\n\n  constructor({ driver, colors, level }: LoggerConfig) {\n    this.driver = driver\n    this.colors = colors\n\n    if (level) {\n      this.logLevel = level\n    }\n  }\n\n  setLevel(level: LevelType): void {\n    this.logLevel = level\n  }\n\n  public getDriver(): LoggerDriver {\n    return this.driver\n  }\n\n  public getColors(): ColorCollection {\n    return this.colors\n  }\n\n  private shouldLog(msgLevel: number) {\n    return this.logLevel <= msgLevel // @todo: bit operations\n  }\n\n  log(msgText: string | Message | MessageBlock, prefix?: string, offset = 0): void {\n    this.driver.log(this.buildMessage(msgText, prefix, offset))\n  }\n\n  info(msgText: string | Message | MessageBlock, prefix?: string, offset = 0): void {\n    if (!this.shouldLog(LEVEL_INFO)) {\n      return\n    }\n\n    const msg = this.buildMessage(msgText, prefix, offset)\n\n    this.driver.info(msg)\n  }\n\n  debug(msgText: string | Message | MessageBlock, prefix?: string, offset = 0) {\n    if (!this.shouldLog(LEVEL_DEBUG)) {\n      return\n    }\n\n    this.driver.debug(this.buildMessage(msgText, prefix, offset))\n  }\n\n  error(msgText: string | Message | MessageBlock, prefix?: string, offset = 0) {\n    if (!this.shouldLog(LEVEL_ERROR)) {\n      return\n    }\n\n    this.driver.error(this.buildMessage(msgText, prefix, offset))\n  }\n\n  trace(msgText: string | Message | MessageBlock, prefix?: string, offset = 0) {\n    if (!this.shouldLog(LEVEL_TRACE)) {\n      return\n    }\n\n    this.driver.trace(this.buildMessage(msgText, prefix, offset))\n  }\n\n  panel(\n    panelText: string | MessageBlock,\n    { bgColor, color, offset }: PanelOptions = {},\n    baseText?: string | MessageBlock\n  ) {\n    const msg = Message.instance(undefined, this.colors).pushBlock(\n      MessageBlock.instance(panelText, { colors: this.colors })\n        .background(bgColor || 'white')\n        .color(color || 'gray')\n        .offsetLeft(offset || 0)\n        .borderRadius(3)\n        .padding(2, 4),\n\n      baseText ? MessageBlock.instance(baseText, { colors: this.colors }).offsetLeft(1) : null\n    )\n\n    this.driver.log(msg)\n  }\n\n  private buildMessage(msgText: string | Message | MessageBlock, prefix?: string, offset: number = 0): Message {\n    if (msgText instanceof Message) {\n      return msgText\n    }\n\n    const msg = new Message(undefined, this.colors)\n\n    if (prefix) {\n      const block = MessageBlock.instance(prefix, { colors: this.colors }).offsetRight(1)\n\n      if (offset) {\n        block.offsetLeft(offset)\n      }\n\n      msg.pushBlock(block)\n    }\n\n    msg.pushBlock(MessageBlock.instance(msgText, { colors: this.colors }))\n\n    return msg\n  }\n}\n\nexport default Logger\n"],"mappings":"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"}